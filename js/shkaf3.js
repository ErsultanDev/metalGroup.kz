const data = [
    // _____________________________________Металлические бухгалтерские шкафы____________________________________________

    {
        link: "kb 02.html",
        title: "Металлический бухгалтерский шкаф КБС - 02 / 02Т",
        desc: "Металлический бухгалтерский шкаф КБС - 02 предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д. Корпус шкафа изготовлен из стали толщиной 1,5 мм. Толщина двери 1,8+1,2 мм. Внутри бухгалтерского шкафа находится приваренная полка. Дверь коробчатая усиленная, оборудована сертифицированным ключевым замком II класса.  ",
        img: '/images/fulls/shkaf_buh/1.jpg',
        price: 12383,
        code: "8005",
        color: 'color2',
        razmer: 'razmer1'
    },


    {
        link: "kb 09.html",
        title: "Металлический бухгалтерский шкаф КБС - 09",
        desc: "Металлический бухгалтерский шкаф КБС-09 предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д. Корпус шкафа изготовлен из стали толщиной 1,5 мм. Толщина двери - 1,8+1,2 мм. Внутри бухгалтерского шкафа находится приваренная полка. Дверь коробчатая усиленная, оборудована сертифицированным ключевым замком II класса.   ",
        img: '/images/fulls/shkaf_buh/2.jpg',
        price: 81275,
        code: "8015",
        razmer: 'razmer3'

    },


    {
        link: "kb 011t.html",
        title: "Металлический бухгалтерский шкаф КБС - 011Т / 012Т",
        desc: "Металлический бухгалтерский шкаф КБС-011-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д. Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ.",
        img: '/images/fulls/shkaf_buh/3.jpg',
        price: 18136,
        code: "8001",
        razmer: 'razmer1.2',
        color: 'color2',
    },


    {
        link: "kb 041t.html",
        title: "Металлический бухгалтерский шкаф КБС - 041Т",
        desc: "Металлический бухгалтерский шкаф КБС-041-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ.",
        img: '/images/fulls/shkaf_buh/4.jpg',
        price: 57418,
        code: "8011",
        razmer: 'razmer6'
    },


    {
        link: "kb 042t.html",
        title: "Металлический бухгалтерский шкаф КБС - 042Т",
        desc: "Металлический бухгалтерский шкаф КБС-042-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ.",
        img: '/images/fulls/shkaf_buh/5.jpg',
        price: 72267,
        code: "8012",
        color: 'razmer6'
    },

    {
        link: "kb 21t.html",
        title: "Металлический бухгалтерский шкаф КБС - 021 / 021Т",
        desc: "Металлический бухгалтерский шкаф КБС-021-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ.",
        img: '/images/fulls/shkaf_buh/6.jpg',
        price: 64634,
        code: "8016",
        razmer: 'razmer5'
    },

    {
        link: "kb 23t.html",
        title: "Металлический бухгалтерский шкаф КБС - 023Т",
        desc: "Металлический бухгалтерский шкаф КБС-023-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ.",
        img: '/images/fulls/shkaf_buh/7.jpg',
        price: 30167,
        code: "8017",
        color: 'color2',
        razmer: 'razmer5'
    },

    {
        link: "kb 031t.html",
        title: "Металлический бухгалтерский шкаф КБС - 031Т",
        desc: "Металлический бухгалтерский шкаф КБС-031-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ. ",
        img: '/images/fulls/shkaf_buh/8.jpg',
        price: 33354,
        code: "8007",
        color: 'color2',
        razmer: 'razmer2'
    },


    {
        link: "kb 032t.html",
        title: "Металлический бухгалтерский шкаф КБС - 032Т",
        desc: "Металлический бухгалтерский шкаф КБС-032-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ. Корпус шкафа изготовлен из стали толщиной 1,5 мм. Толщина двери 1,8+1,2 мм. Внутри бухгалтерского шкафа находится приваренная полка. ",
        img: '/images/fulls/shkaf_buh/9.jpg',
        price: 97140,
        code: "8008",
        razmer: 'razmer4'
    },



    {
        link: "kb 033t.html",
        title: "Металлический бухгалтерский шкаф КБС - 033 / 033Т",
        desc: "Металлический бухгалтерский шкаф КБС-033-Т предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Модели с индексом «т» оснащены дополнительным отсеком ограниченного доступа (трейзер), который расположен в верхней части шкафа, запираемый на ключ. Корпус шкафа изготовлен из стали толщиной 1,5 мм. Толщина двери 1,8+1,2 мм. Шкаф имеет 3 отделения. Внутри бухгалтерского шкафа находится приваренная полка. ",
        img: '/images/fulls/shkaf_buh/10.jpg',
        price: 104613,
        code: "8010",
        razmer: 'razmer4'
    },


    {
        link: "kb 05.html",
        title: "Металлический бухгалтерский шкаф КБС - 05",
        desc: "Металлический бухгалтерский шкаф КБС-05 предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Корпус шкафа изготовлен из стали толщиной 1,5 мм. Толщина двери - 1,8+1,2 мм. Внутри бухгалтерского шкафа находятся четыре приваренных полки. Дверь коробчатая усиленная, оборудована сертифицированным ключевым замком II класса.   ",
        img: '/images/fulls/shkaf_buh/11.jpg',
        price: 97579,
        code: "8013",
        razmer: 'razmer2'
    },

    {
        link: "kb 06.html",
        title: "Металлический бухгалтерский шкаф КБС - 06",
        desc: "Металлический бухгалтерский шкаф КБС-06 предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Корпус шкафа изготовлен из стали толщиной 1,5 мм. Толщина двери - 1,8+1,2 мм. Металлический бухгалтерский шкаф имеет 4 отделения. Дверь коробчатая усиленная, оборудована сертифицированным ключевым замком II класса.",
        img: '/images/fulls/shkaf_buh/12.jpg',
        price: 119208,
        code: "8014",
        razmer: 'razmer2'
    },

    {
        link: "kb 10.html",
        title: "Металлический бухгалтерский шкаф КБС - 10",
        desc: "Металлический бухгалтерский шкаф КБС-10 предназначен для хранения офисной и бухгалтерской документации, учредительных документов, электронных носителей информации и т.д.  Корпус шкафа изготовлен из стали толщиной 1,5 мм. Толщина двери - 1,8+1,2 мм. Внутри бухгалтерского шкафа находится приваренная полка. Дверь коробчатая усиленная, оборудована сертифицированным ключевым замком II класса.",
        img: '/images/fulls/shkaf_buh/13.jpg',
        price: 184449,
        code: "8004",
        razmer: 'razmer2'
    },


]

const labels = document.getElementById('shkaf3Js');

const monoblocksBlock = document.getElementById('shkaf3Block');
const priceSort = document.getElementById("priceSort");

let priceSortedArray = data.sort(function (a, b) {
  let x = a.price;
  let y = b.price;

  return x - y;
});
let initialArray = priceSortedArray;

let initStage = true;
let priceOptionFirst = document.querySelector(".priceOptionFirst");
let priceOptionSecond = document.querySelector(".priceOptionSecond");

priceOptionFirst.addEventListener("click", function () {
  priceSortedArray = data.sort(function (a, b) {
    let x = a.price;
    let y = b.price;

    return x - y;
  });
  initialArray = priceSortedArray;
  filterArray();
});
priceOptionSecond.addEventListener("click", function () {

  priceSortedArray = data.sort(function (a, b) {
    let x = a.price;
    let y = b.price;

    return y - x;
  });
  initialArray = priceSortedArray;
  filterArray();
});


let myTabOne = document.querySelector('.myTabOne');
let myTabTwo = document.querySelector('.myTabTwo');


myTabOne.addEventListener('click', function() {
    monoblocksBlock.classList.remove('cardProductBlock');
    labels.classList.remove('cardProduct');
});

myTabTwo.addEventListener('click', function() {
    monoblocksBlock.classList.add('cardProductBlock');
    labels.classList.add('cardProduct');
});


function displayBlock(array) {
    monoblocksBlock.innerHTML = "";
    let video = document.createElement('div');
    // <p>Звоните прямо сейчас: <br><a href="tel:87015112200">8(727)<span> 344-99-00</span></a>; <a href="tel:+77012667700"><b>+7 701 266-77-00</b></a></p>
    video.innerHTML = `
            <p>Звоните прямо сейчас: <br><a href="tel:87015112200">8(727)<span> 344-99-00</span></a>; <a href="tel:+77012667700"><b>+7 701 266-77-00</b></a></p>
           `;

    array.map((a) => {
        let item = document.createElement('div');
        item.classList.add("mainCard");

        var formatter = function(priceSum) {
            let mn = 0;
            let price = priceSum.toString()
            for (let ij = price.length; ij > 0; ij--) {
                if (mn % 3 == 0) {
                    price = [price.slice(0, ij), " ", price.slice(ij)].join('');
                }
                mn++;
            }
            return price;
        }
        item.innerHTML = `
             <div class="cardProductItem">
        <a href="${a.link}">
        <span class="cardProductItem_code">Код товара: ${a.code}</span>
            <div class="cardProductItem_img">
                <img src="${a.img}">
            </div>
            <div class="cardProductItem_content">
                <h3>${a.title} </h3>
              
                <div class="cardProductItem_info">
                    <div class="cardProductItem_info_sub">
                        <div>
                            <img src="/images/productInfo1.png" alt="">
                        </div>
                        <div>
                            <p>Есть в наличии</p>
                        </div>
                    </div>
                    <div class="cardProductItem_info_sub">
                    <div>
                        <img src="/images/productInfo2.png" alt="">
                    </div>
                    <div class="cardProductItem_info_sub_text">
                        <p>Доставка </p>
                        <p><p class="span_free"> - БЕСПЛАТНО</p></p>
                    </div>
                </div>
                    <div class="cardProductItem_info_sub">
                        <div>
                            <img src="/images/productInfo3.png" alt="">
                        </div>
                        <div class="cardProductItem_info_sub_text">
                            <p>Установка</p>
                            <p><p class="span_free"> - БЕСПЛАТНО</p></p>
                        </div>
                    </div>
                </div>
                <div class="cardProductItem_price_btn">
                <span class="cardProductItem_price"> от ${formatter(a.price)}  тг</span>
                </div>
             
            </div>
        </a>
    </div>
           
            `;
        monoblocksBlock.appendChild(item);

    })

}

function displayList(array) {
    labels.innerHTML = "";
    let video = document.createElement('div');
    // 
    video.innerHTML = `
    <p>Звоните прямо сейчас: <br><a href="tel:87273449900">8(727)<span> 344-99-00</span></a>; <a href="tel:+77012667700"><b>+7 701 266-77-00</b></a></p>
        `;

    array.map((a) => {
        let item = document.createElement('div');
        item.classList.add("main");
        var formatter = function(priceSum) {
            let mn = 0;
            let price = priceSum.toString()
            for (let ij = price.length; ij > 0; ij--) {
                if (mn % 3 == 0) {
                    // price.splice(ij, 0, " ")
                    price = [price.slice(0, ij), " ", price.slice(ij)].join('');
                }
                mn++;
            }
            return price;
        }

        item.innerHTML = `
    <li>
    <div id="ggg">
    <div class="firstly">
    <a  href="${a.link}"> 
    <img class="boximagee" src="${a.img}"
               style="float:left">
   </div>
   <br>
   <div class="secondly">
       <h2>${a.title}</h2>
       <hr><span style="color:#CCCCCC; font-size:14px">Код товара: ${a.code}</span><br>
       <p>${a.desc}</p>
       <p><span class="item-price-indicator_second">Цена: от ${formatter(a.price)} тг </span></p>
       </div>
       </a>
       <div class="thirdly">
       <a class="but btn-zayavka" href="${a.link}">Перейти</a>
   </div>
     </div>
    </div>
    </li><br>
    
`;
        labels.appendChild(item);

    })
}

function showInitialStage() {
    displayBlock(initialArray);
    displayList(initialArray);
    let params = countParam(initialArray);
    showParamCounters(params)
}


showInitialStage();

let filterParam = {
    razmer: [],
}



function filterArray() {
    let updatedArray = initialArray
        .filter(function(a) {
            if (filterParam.razmer.length !== 0) {
                for (let i = 0; i < filterParam.razmer.length; i++) {
                    if (a.razmer === filterParam.razmer[i]) {
                        return a;
                    }
                }
            } else {
                return a;
            }
        })



    let params = countParam(updatedArray);
    showParamCounters(params)


    if (updatedArray.length !== 0) {
        displayBlock(updatedArray)
        displayList(updatedArray)
        addFilterOption(filterOptionArray)
    } else {
        clickArr[clickArr.length - 1].checked = false;
        clickArr.pop()
        filterOptionArray.pop()
        errorMsg()

        updateFilterParam()
    }
}

let clickArr = []
let filterOptionArray = []
let btnArray = []



const razmer1 = document.getElementById('razmer1');
const razmer1_2 = document.getElementById('razmer1.2');
const razmer2 = document.getElementById('razmer2');
const razmer3 = document.getElementById('razmer3');
const razmer4 = document.getElementById('razmer4');
const razmer5 = document.getElementById('razmer5');
const razmer6 = document.getElementById('razmer6');
const razmer7 = document.getElementById('razmer7');


function updateFilterParam() {

    filterParam.razmer = [];
    if (razmer1.checked === true) {
        filterParam.razmer.push('razmer1');
    }

    if (razmer1_2.checked === true) {
        filterParam.razmer.push('razmer1.2');
    }

    if (razmer2.checked === true) {
        filterParam.razmer.push('razmer2');
    }

    if (razmer3.checked === true) {
        filterParam.razmer.push('razmer3');
    }

    if (razmer4.checked === true) {
        filterParam.razmer.push('razmer4');
    }

    if (razmer5.checked === true) {
        filterParam.razmer.push('razmer5');
    }

    if (razmer6.checked === true) {
        filterParam.razmer.push('razmer6');
    }

    if (razmer7.checked === true) {
        filterParam.razmer.push('razmer7');
    }

    filterArray()
}

function spliceMethod(value) {
    const idx = clickArr.indexOf(value);
    if (idx > -1) {
        clickArr.splice(idx, 1);
    }
}

function spliceMethodSecond(value) {
    const idx = filterOptionArray.indexOf(value);
    if (idx > -1) {
        filterOptionArray.splice(idx, 1);
    }
}




function razmer1BtnClick() {
    if (razmer1.checked == true) {
        filterOptionArray.push('2000x850x500 мм')
        clickArr.push(razmer1)
        arrCounter = true;
    } else {
        spliceMethod(razmer1);
        spliceMethodSecond('2000x850x500 мм')
        arrCounter = false;
    }
    updateFilterParam()
}


function razmer1_2BtnClick() {
    if (razmer1_2.checked == true) {
        filterOptionArray.push('1950x800x450 мм')
        clickArr.push(razmer1_2)
        arrCounter = true;
    } else {
        spliceMethod(razmer1_2);
        spliceMethodSecond('1950x800x450 мм')
        arrCounter = false;
    }
    updateFilterParam()
}

function razmer2BtnClick() {
    if (razmer2.checked == true) {
        filterOptionArray.push('1860x960x450 мм')
        clickArr.push(razmer2)
        arrCounter = true;
    } else {
        spliceMethod(razmer2);
        spliceMethodSecond('1860x960x450 мм')
        arrCounter = false;
    }
    updateFilterParam()
}

function razmer3BtnClick() {
    if (razmer3.checked == true) {
        filterOptionArray.push('1800x900x400 мм')
        clickArr.push(razmer3)
        arrCounter = true;
    } else {
        spliceMethod(razmer3);
        spliceMethodSecond('1800x900x400 мм')
        arrCounter = false;
    }
    updateFilterParam()
}


function razmer4BtnClick() {
    if (razmer4.checked == true) {
        filterOptionArray.push('1860x425x500 мм')
        clickArr.push(razmer4)
        arrCounter = true;
    } else {
        spliceMethod(razmer4);
        spliceMethodSecond('1860x425x500 мм')
        arrCounter = false;
    }
    updateFilterParam()
}



function razmer5BtnClick() {
    if (razmer5.checked == true) {
        filterOptionArray.push('1300x900x400 мм')
        clickArr.push(razmer5)
        arrCounter = true;
    } else {
        spliceMethod(razmer5);
        spliceMethodSecond('1300x900x400 мм')
        arrCounter = false;
    }
    updateFilterParam()
}


function razmer6BtnClick() {
    if (razmer6.checked == true) {
        filterOptionArray.push('930x850x500 мм')
        clickArr.push(razmer6)
        arrCounter = true;
    } else {
        spliceMethod(razmer6);
        spliceMethodSecond('930x850x500 мм')
        arrCounter = false;
    }
    updateFilterParam()
}



function razmer7BtnClick() {
    if (razmer7.checked == true) {
        filterOptionArray.push('680x425x500  мм')
        clickArr.push(razmer7)
        arrCounter = true;
    } else {
        spliceMethod(razmer7);
        spliceMethodSecond('680x425x500  мм')
        arrCounter = false;
    }
    updateFilterParam()
}



razmer1.addEventListener('click', razmer1BtnClick)
razmer1_2.addEventListener('click', razmer1_2BtnClick)
razmer2.addEventListener('click', razmer2BtnClick)
razmer3.addEventListener('click', razmer3BtnClick)
razmer4.addEventListener('click', razmer4BtnClick)
razmer5.addEventListener('click', razmer5BtnClick)
razmer6.addEventListener('click', razmer6BtnClick)
razmer7.addEventListener('click', razmer7BtnClick)




// let checkBoxArr = []
//     // settings関数で初期設定 全体に適応させたい場合
// iziToast.settings({
//     timeout: 3000, // default timeout
//     resetOnHover: true,
//     // icon: '', // icon class
//     transitionIn: 'flipInX',
//     transitionOut: 'flipOutX',
//     position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center
//     onOpen: function() {
//         // console.log('callback abriu!');
//     },
//     onClose: function() {
//         // console.log("callback fechou!");
//     }
// });


// error
// function errorMsg() {
//     iziToast.warning({ title: '', message: 'По таким параметрам продуктов не найдено' });
// }


const filter = document.getElementById("filter");
let arrCounter = true;

function addFilterOption(arr) {
    let index = 0;
    filter.innerHTML = "";
    arr.map(a => {
        let filterOption = document.createElement('div');
        filterOption.setAttribute("data-id", index)
        filterOption.id = "filterOption"
        filterOption.classList.add('filter-option')
        if (arrCounter == true) {
            filterOption.classList.add('filter-animation')
        }
        if (index > 0) {
            document.querySelector(`[data-id="${index - 1}"]`).classList.remove('filter-animation');
        }
        filterOption.innerHTML = `
    <span class="filter-option-value" data-id="${index}">${a} 
        <svg xmlns="https://www.w3.org/2000/svg" style="
        pointer-events: none;
        margin-left: 8.5px;" data-id="${index} width="10px" height="10px" viewBox="0 0 7 7" id="filterOptionSvg" fill="none">
            <path data-id="${index} id="filterOptionPath" fill-rule="evenodd" clip-rule="evenodd" d="M4.00199 4.7091L6.64844 7.35554L7.35554 6.64844L4.7091 4.00199L7.35554 1.35554L6.64844 0.648438L4.00199 3.29488L1.35554 0.648438L0.648438 1.35554L3.29488 4.00199L0.648438 6.64844L1.35554 7.35554L4.00199 4.7091Z" fill="#C4C4C4"></path>
        </svg>
    </span>
    `;
        filter.appendChild(filterOption);
        index++;
    })
}

let filterOption = document.querySelector(".filter-option");

document.addEventListener(
    "click",
    function(e) {
        e = e || window.event;
        let target = e.srcElement;
        if (
            target.id === "filterOption" ||
            target.parentNode.id === "filterOption"
        ) {
            arrCounter = false;
            let selectedId = parseInt(target.getAttribute('data-id'), 10);
            removeFilterElement(selectedId)
        }
    },
    false
);


function removeFilterElement(value) {
    filterOptionArray.splice(value, 1);
    clickArr[value].checked = false;
    clickArr.splice(value, 1)
    updateFilterParam();
}

function countParam(array) {
    let razmer1 = 0;
    let razmer1_2 = 0;
    let razmer2 = 0;
    let razmer3 = 0;
    let razmer4 = 0;
    let razmer5 = 0;
    let razmer6 = 0;
    let razmer7 = 0;




    for (let index = 0; index < array.length; index++) {
        if (array[index].razmer == 'razmer1') {
            razmer1++;
        } else if (array[index].razmer == 'razmer1.2') {
            razmer1_2++;
        } else if (array[index].razmer == 'razmer2') {
            razmer2++;
        } else if (array[index].razmer == 'razmer3') {
            razmer3++;
        } else if (array[index].razmer == 'razmer4') {
            razmer4++;
        } else if (array[index].razmer == 'razmer5') {
            razmer5++;
        } else if (array[index].razmer == 'razmer6') {
            razmer6++;
        } else if (array[index].razmer == 'razmer7') {
            razmer7++;
        }


    }

    return [razmer1, razmer1_2, razmer2, razmer3, razmer4, razmer5, razmer6, razmer7]

}

function showParamCounters(array) {
    for (let index = 0; index < array.length; index++) {
        document.getElementById(`${index+1}param`).innerHTML = array[index]
    }
}

// var filename = window.location.href.split('/').pop().split('#')[0].split('?')[0];
// console.log(filename);