const data1 = [
  {
    // ____________________________________Холодильные шкафы стеклянные однодверные___________________________________________
    link: "dm105s.html",
    title: "Холодильный шкаф Polair DM105-S",
    desc: "Холодильный шкаф Polair DM105-S – идеальное решение для продажи напитков и продуктов. Современный и надежный шкаф оснащен профессиональной динамической холодильной системой, имеет цельнозаливной пенополиуретаном корпус из стали с полимерным покрытием (снаружи и изнутри).",
    img: "/images/fulls/holod/shkaf/polair/9.jpg",
    price: 174825,
    code: "1517",
  },
  {
    link: "dm107s.html",
    title: "Холодильный шкаф Polair DM107-S без канапе",
    desc: "Холодильный шкаф DM107-S – вместительный и функциональный, позволяет хранить и экспонировать значительные объемы продуктов и напитков. Подходит для предприятий общественного питания и магазинов всех форматов и форм торговли. Вертикальная подсветка равномерно освещает товар на всех полках шкафа.",
    img: "/images/fulls/holod/shkaf/polair/10.png",
    price: 212565,
    code: "1518",
  },
  {
    link: "dp102s.html",
    title: "Холодильный шкаф Polair DP102-S",
    desc: "Шкаф разработан в соответствии с требованиями самых взыскательных покупателей к высокому качеству демонстрации и продажи икры и пресервов, надежному хранению этих деликатных продуктов, оптимизации торговых площадей и работы персонала, элегантному и современному дизайну оборудования, способному органично вписаться в любой интерьер.",
    img: "/images/fulls/holod/shkaf/polair/16.jpg",
    price: 124453,
    code: "1522",
  },
  {
    link: "dm102_bravo.html",
    title: "Холодильный шкаф Polair DM102-Bravo",
    desc: "Холодильный шкаф Polair DM102-Bravo с замком предназначен для демонстрации и продажи продуктов и напитков.",
    img: "/images/fulls/holod/shkaf/polair/17.jpg",
    price: 115150,
    code: "1523",
  },
  {
    link: "dm104_bravo.html",
    title: "Холодильный шкаф Polair DM104-Bravo",
    desc: "POLAIR Bravo – компактные и вместительные холодильные шкафы объемом до 400 л. Цельнозаливной корпус, динамическая система охлаждения, увеличенная нагрузка на полку - до 50 кг, подсветка выкладки и канапе светодиодными лампами.",
    img: "/images/fulls/holod/shkaf/polair/19.jpg",
    price: 172050,
    code: "1524",
  },
  {
    link: "bc105.html",
    title: "Холодильный шкаф Polair BC105",
    desc: "Холодильный шкаф Polair со стеклянными дверьми Polair BC105 предназначен для охлаждения, хранения, демонстрации и продажи практически любого вида товара. Данный шкаф изготовлен из цельнозаливного корпуса, а так же имеет небольшой воздухоохладитель и обладает высокой эффективностью и пониженным шумом.",
    img: "/images/fulls/holod/shkaf/polair/20.jpg",
    price: 167960,
    code: "1525",
  },
  {
    link: "shx.html",
    title: "Холодильный шкаф ШХ",
    desc: "Холодильный шкаф ШХ специально разработан для демонстрации и продажи икры, рыбных деликатесов и пресервов с учетом всех требований к условиям хранения и экспозиции этих деликатных продуктов с температурой хранения от -6°С до 6°С.",
    img: "/images/fulls/holod/shkaf/1.jpg",
    price: 162504,
    code: "1502",
  },
  {
    link: "bonvini.html",
    title: "Холодильный шкаф Bonvini",
    desc: "Bonvini - профессиональные холодильные шкафы, современная светодиодная подсветка, имеющая компактные размеры, своим белым холодным цветом свечения, придает особый, привлекательный вид охлаждаемому продукту.",
    img: "/images/fulls/holod/shkaf/20.jpg",
    price: 214500,
    code: "1515",
  },
  {
    link: "capri390c.html",
    title: "Холодильный шкаф Capri П-390С",
    desc: "Шкаф холодильный Capri П-390С среднетемпературный предназначен для кратковременного хранения, демонстрации и продажи, пред- варительно охлаждённых до температуры охлаждаемого объёма, пищевых продуктов и напитков.",
    img: "/images/fulls/holod/shkaf/2.jpg",
    price: 157039,
    code: "1503",
  },
  {
    link: "capri490ck.html",
    title: "Холодильный шкаф Capri П-490СК",
    desc: "Шкаф холодильный Capri П-490СК среднетемпературный предназначен для кратковременного хранения, демонстрации и продажи, пред- варительно охлаждённых до температуры охлаждаемого объёма, пищевых продуктов и напитков.",
    img: "/images/fulls/holod/shkaf/3.jpg",
    price: 162410,
    code: "1504",
  },
  {
    link: "carboma.html",
    title: "Холодильный шкаф Carboma ULTRA",
    desc: "Холодильный шкаф Carboma ULTRA - это современный элегантный дизайн Вашего магазина, бара, ресторана, высокая надежность,значительная экономия в потреблении электроэнергии.",
    img: "/images/fulls/holod/polus/shkaf/1.png",
    price: 195935,
    code: "1512",
  },
  {
    link: "holodilnyi_shkaf_carboma.html",
    title: "Холодильный шкаф Carboma Premium",
    desc: "Холодильный шкаф Carboma Premium предназначен для демонстрации напитков, кондитерских изделий и десертов в магазинах, кафе, ресторанах.",
    img: "/images/fulls/holod/polus/shkaf/3.png",
    price: 211165,
    code: "1513",
  },
  {
    link: "capri05ck.html",
    title: "Холодильный шкаф Capri 0,5СК",
    desc: "Холодильные шкафы Капри 0,5СК бывают двух размеров. Данные шкафы предназначены для кратковременного хранения, демонстрации и продажи, предварительно охлажденных до температуры охлаждаемого объема, пищевых продуктов и напитков.",
    img: "/images/fulls/holod/shkaf/4.jpg",
    price: 160205,
    code: "1505",
  },
];

const labels = document.getElementById("holodShtafSteklo");

const monoblocksBlock = document.getElementById("shkaf1Block");
const priceSort = document.getElementById("priceSort");

let priceSortedArray = data.sort(function (a, b) {
  let x = a.price;
  let y = b.price;

  return x - y;
});
let initialArray = priceSortedArray;

let initStage = true;
let priceOptionFirst = document.querySelector(".priceOptionFirst");
let priceOptionSecond = document.querySelector(".priceOptionSecond");

priceOptionFirst.addEventListener("click", function () {
  priceSortedArray = data.sort(function (a, b) {
    let x = a.price;
    let y = b.price;

    return x - y;
  });
  initialArray = priceSortedArray;
  filterArray();
});
priceOptionSecond.addEventListener("click", function () {

  priceSortedArray = data.sort(function (a, b) {
    let x = a.price;
    let y = b.price;

    return y - x;
  });
  initialArray = priceSortedArray;
  filterArray();
});





let myTabOne = document.querySelector(".myTabOne");
let myTabTwo = document.querySelector(".myTabTwo");

myTabOne.addEventListener("click", function () {
  monoblocksBlock.classList.remove("cardProductBlock");
  labels.classList.remove("cardProduct");
});

myTabTwo.addEventListener("click", function () {
  monoblocksBlock.classList.add("cardProductBlock");
  labels.classList.add("cardProduct");
});

function displayBlock(array) {
  monoblocksBlock.innerHTML = "";
  let video = document.createElement("div");
  // <p>Звоните прямо сейчас: <br><a href="tel:87015112200">8(727)<span> 344-99-00</span></a>; <a href="tel:+77012667700"><b>+7 701 266-77-00</b></a></p>
  video.innerHTML = `
      <p>Звоните прямо сейчас: <br><a href="tel:87015112200">8(727)<span> 344-99-00</span></a>; <a href="tel:+77012667700"><b>+7 701 266-77-00</b></a></p>
     `;

  array.map((a) => {
    let item = document.createElement("div");
    item.classList.add("mainCard");

    var formatter = function (priceSum) {
      let mn = 0;
      let price = priceSum.toString();
      for (let ij = price.length; ij > 0; ij--) {
        if (mn % 3 == 0) {
          price = [price.slice(0, ij), " ", price.slice(ij)].join("");
        }
        mn++;
      }
      return price;
    };
    item.innerHTML = `
    <div class="cardProductItem">
    <a href="${a.link}">
    <span class="cardProductItem_code">Код товара: ${a.code}</span>
        <div class="cardProductItem_img">
            <img src="${a.img}">
        </div>
        <div class="cardProductItem_content">
            <h3>${a.title} </h3>
          
            <div class="cardProductItem_info">
                <div class="cardProductItem_info_sub">
                    <div>
                        <img src="/images/productInfo1.png" alt="">
                    </div>
                    <div>
                        <p>Есть в наличии</p>
                    </div>
                </div>
                <div class="cardProductItem_info_sub">
                <div>
                    <img src="/images/productInfo2.png" alt="">
                </div>
                <div class="cardProductItem_info_sub_text">
                    <p>Доставка </p>
                    <p><p class="span_free"> - БЕСПЛАТНО</p></p>
                </div>
            </div>
                <div class="cardProductItem_info_sub">
                    <div>
                        <img src="/images/productInfo3.png" alt="">
                    </div>
                    <div class="cardProductItem_info_sub_text">
                        <p>Установка</p>
                        <p><p class="span_free"> - БЕСПЛАТНО</p></p>
                    </div>
                </div>
            </div>
            <div class="cardProductItem_price_btn">
            <span class="cardProductItem_price"> от ${formatter(a.price)}  тг</span>
            </div>
         
        </div>
    </a>
</div>
     
      `;
    monoblocksBlock.appendChild(item);
  });
}

function displayList(array) {
  labels.innerHTML = "";
  let video = document.createElement("div");
  //
  video.innerHTML = `
<p>Звоните прямо сейчас: <br><a href="tel:87273449900">8(727)<span> 344-99-00</span></a>; <a href="tel:+77012667700"><b>+7 701 266-77-00</b></a></p>
  `;

  array.map((a) => {
    let item = document.createElement("div");
    item.classList.add("main");
    var formatter = function (priceSum) {
      let mn = 0;
      let price = priceSum.toString();
      for (let ij = price.length; ij > 0; ij--) {
        if (mn % 3 == 0) {
          // price.splice(ij, 0, " ")
          price = [price.slice(0, ij), " ", price.slice(ij)].join("");
        }
        mn++;
      }
      return price;
    };

    item.innerHTML = `
<li>
<div id="ggg">
<div class="firstly">
<a  href="${a.link}"> 
<img class="boximagee" src="${a.img}"
         style="float:left">
</div>
<br>
<div class="secondly">
 <h2>${a.title}</h2>
 <hr><span style="color:#CCCCCC; font-size:14px">Код товара: ${
   a.code
 }</span><br>
 <p>${a.desc}</p>
 <p><span class="item-price-indicator_second">Цена: ${formatter(
   a.price
 )} тг </span></p>
 </div>
 </a>
 <div class="thirdly">
 <a class="but btn-zayavka" href="${a.link}">Перейти</a>
</div>
</div>
</div>
</li><br>

`;
    labels.appendChild(item);
  });
}

function showInitialStage() {
  displayBlock(initialArray);
  displayList(initialArray);
  let params = countParam(initialArray);
  showParamCounters(params);
}

showInitialStage();

let filterParam = {
  color: [],
  paperWidth: [],
  winding: [],
};

function filterArray() {
  let updatedArray = initialArray
    .filter(function (a) {
      if (filterParam.color.length !== 0) {
        for (let i = 0; i < filterParam.color.length; i++) {
          if (a.color === filterParam.color[i]) {
            return a;
          }
        }
      } else {
        return a;
      }
    })
    .filter(function (a) {
      if (filterParam.paperWidth.length !== 0) {
        for (let i = 0; i < filterParam.paperWidth.length; i++) {
          if (a.paperWidth === filterParam.paperWidth[i]) {
            return a;
          }
        }
      } else {
        return a;
      }
    })
    .filter(function (a) {
      if (filterParam.winding.length !== 0) {
        for (let i = 0; i < filterParam.winding.length; i++) {
          if (a.winding === filterParam.winding[i]) {
            return a;
          }
        }
      } else {
        return a;
      }
    });

  let params = countParam(updatedArray);
  showParamCounters(params);

  if (updatedArray.length !== 0) {
    displayList(updatedArray);
    displayBlock(updatedArray);
    addFilterOption(filterOptionArray);
  } else {
    clickArr[clickArr.length - 1].checked = false;
    clickArr.pop();
    filterOptionArray.pop();
    errorMsg();
    updateFilterParam();
  }
}

let clickArr = [];
let filterOptionArray = [];
let btnArray = [];

const whiteBtn = document.getElementById("whiteBtn");
const blackBtn = document.getElementById("blackBtn");
const grayBtn = document.getElementById("grayBtn");
const firstWidthBtn = document.getElementById("firstWidthBtn");
const secondWidthBtn = document.getElementById("secondWidthBtn");
const thirdWidthBtn = document.getElementById("thirdWidthBtn");
const withAutoCutBtn = document.getElementById("withAutoCutBtn");
const wtAutoCutBtn = document.getElementById("wtAutoCutBtn");
const autoSeperationBtn = document.getElementById("autoSeperationBtn");
const noAutoSeperationBtn = document.getElementById("noAutoSeperationBtn");

function updateFilterParam() {
  filterParam.color = [];

  if (whiteBtn.checked === true) {
    filterParam.color.push("white");
  }

  if (blackBtn.checked === true) {
    filterParam.color.push("black");
  }

  if (grayBtn.checked === true) {
    filterParam.color.push("gray");
  }

  filterParam.paperWidth = [];

  if (firstWidthBtn.checked === true) {
    filterParam.paperWidth.push(76);
  }

  if (secondWidthBtn.checked === true) {
    filterParam.paperWidth.push(80);
  }

  if (thirdWidthBtn.checked === true) {
    filterParam.paperWidth.push(104);
  }

  filterParam.winding = [];

  if (autoSeperationBtn.checked === true) {
    filterParam.winding.push(true);
  }

  if (noAutoSeperationBtn.checked === true) {
    filterParam.winding.push(false);
  }

  filterArray();
}

function spliceMethod(value) {
  const idx = clickArr.indexOf(value);
  if (idx > -1) {
    clickArr.splice(idx, 1);
  }
}

function spliceMethodSecond(value) {
  const idx = filterOptionArray.indexOf(value);
  if (idx > -1) {
    filterOptionArray.splice(idx, 1);
  }
}

function whiteBtnClick() {
  if (whiteBtn.checked == true) {
    filterOptionArray.push("белый");
    clickArr.push(whiteBtn);
    arrCounter = true;
  } else {
    spliceMethod(whiteBtn);
    spliceMethodSecond("белый");
    arrCounter = false;
  }
  updateFilterParam();
}

function blackBtnClick() {
  if (blackBtn.checked == true) {
    filterOptionArray.push("черный");
    clickArr.push(blackBtn);
    arrCounter = true;
  } else {
    spliceMethod(blackBtn);
    spliceMethodSecond("черный");
    arrCounter = false;
  }
  updateFilterParam();
}

function grayBtnClick() {
  if (grayBtn.checked == true) {
    filterOptionArray.push("черный");
    clickArr.push(grayBtn);
    arrCounter = true;
  } else {
    spliceMethod(grayBtn);
    spliceMethodSecond("черный");
    arrCounter = false;
  }
  updateFilterParam();
}

function firstWidthBtnClick() {
  if (firstWidthBtn.checked == true) {
    filterOptionArray.push("до 80мм");
    clickArr.push(firstWidthBtn);
    arrCounter = true;
  } else {
    spliceMethod(firstWidthBtn);
    spliceMethodSecond("до 80мм");
    arrCounter = false;
  }
  updateFilterParam();
}

function secondWidthBtnClick() {
  if (secondWidthBtn.checked == true) {
    filterOptionArray.push("до 82мм");
    clickArr.push(secondWidthBtn);
    arrCounter = true;
  } else {
    spliceMethod(secondWidthBtn);
    spliceMethodSecond("до 82мм");
    arrCounter = false;
  }
  updateFilterParam();
}

function thirdWidthBtnClick() {
  if (thirdWidthBtn.checked == true) {
    filterOptionArray.push("до 120мм");
    clickArr.push(thirdWidthBtn);
    arrCounter = true;
  } else {
    spliceMethod(thirdWidthBtn);
    spliceMethodSecond("до 120мм");
    arrCounter = false;
  }
  updateFilterParam();
}

function autoSeperationBtnClick() {
  if (autoSeperationBtn.checked == true) {
    filterOptionArray.push("имеется");
    clickArr.push(autoSeperationBtn);
    arrCounter = true;
  } else {
    spliceMethod(autoSeperationBtn);
    spliceMethodSecond("имеется");
    arrCounter = false;
  }
  updateFilterParam();
}

function noAutoSeperationBtnClick() {
  if (noAutoSeperationBtn.checked == true) {
    filterOptionArray.push("отсуствует");
    clickArr.push(noAutoSeperationBtn);
    arrCounter = true;
  } else {
    spliceMethod(noAutoSeperationBtn);
    spliceMethodSecond("отсуствует");
    arrCounter = false;
  }
  updateFilterParam();
}

function errorMsg() {
  iziToast.warning({
    title: "",
    message: "По таким параметрам продуктов не найдено",
  });
}

const filter = document.getElementById("filter");
let arrCounter = true;

function addFilterOption(arr) {
  let index = 0;
  if (filter != null) {
    filter.innerHTML = "";
  }
  arr.map((a) => {
    let filterOption = document.createElement("div");
    filterOption.setAttribute("data-id", index);
    filterOption.id = "filterOption";
    filterOption.classList.add("filter-option");
    if (arrCounter == true) {
      filterOption.classList.add("filter-animation");
    }
    if (index > 0) {
      document
        .querySelector(`[data-id="${index - 1}"]`)
        .classList.remove("filter-animation");
    }
    filterOption.innerHTML = `
<span class="filter-option-value" data-id="${index}">${a} 
 <svg xmlns="https://www.w3.org/2000/svg" style="
 pointer-events: none;
 margin-left: 8.5px;" data-id="${index} width="10px" height="10px" viewBox="0 0 7 7" id="filterOptionSvg" fill="none">
     <path data-id="${index} id="filterOptionPath" fill-rule="evenodd" clip-rule="evenodd" d="M4.00199 4.7091L6.64844 7.35554L7.35554 6.64844L4.7091 4.00199L7.35554 1.35554L6.64844 0.648438L4.00199 3.29488L1.35554 0.648438L0.648438 1.35554L3.29488 4.00199L0.648438 6.64844L1.35554 7.35554L4.00199 4.7091Z" fill="#C4C4C4"></path>
 </svg>
</span>
`;
    filter.appendChild(filterOption);
    index++;
  });
}

let filterOption = document.querySelector(".filter-option");

document.addEventListener(
  "click",
  function (e) {
    e = e || window.event;
    let target = e.srcElement;
    if (
      target.id === "filterOption" ||
      target.parentNode.id === "filterOption"
    ) {
      arrCounter = false;
      let selectedId = parseInt(target.getAttribute("data-id"), 10);
      removeFilterElement(selectedId);
    }
  },
  false
);

function removeFilterElement(value) {
  filterOptionArray.splice(value, 1);
  clickArr[value].checked = false;
  clickArr.splice(value, 1);
  updateFilterParam();
}

function countParam(array) {
  let color1 = 0;
  let color2 = 0;
  let color3 = 0;
  let paperWidth1 = 0;
  let paperWidth2 = 0;
  let paperWidth3 = 0;
  let winding1 = 0;
  let winding2 = 0;

  for (let index = 0; index < array.length; index++) {
    if (array[index].color == "white") {
      color1++;
    } else if (array[index].color == "black") {
      color2++;
    } else if (array[index].color == "gray") {
      color3++;
    }

    if (array[index].paperWidth == 76) {
      paperWidth1++;
    } else if (array[index].paperWidth == 80) {
      paperWidth2++;
    } else if (array[index].paperWidth == 104) {
      paperWidth3++;
    }

    if (array[index].winding == true) {
      winding1++;
    } else if (array[index].winding == false) {
      winding2++;
    }
  }

  return [
    color1,
    color2,
    color3,
    paperWidth1,
    paperWidth2,
    paperWidth3,
    winding1,
    winding2,
  ];
}

function showParamCounters(array) {
  for (let index = 0; index < array.length; index++) {
    try {
      document.getElementById(`${index + 1}param`).innerHTML = array[index];
    } catch (e) {}
  }
}
